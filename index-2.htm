<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>開發者文檔 | FormLess Extention 開發者文檔</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="logo.png" tppabs="https://wallet.formless.me/logo.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="apple-touch-icon-152x152.png.htm" tppabs="https://wallet.formless.me/icons/apple-touch-icon-152x152.png">
    <meta name="description" content="FormLess Extention 開發者文檔">
    <meta name="theme-color" content="#21a4e7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.a2f7be03.css" as="style"><link rel="preload" href="/assets/js/app.c9e8d0a3.js" as="script"><link rel="preload" href="/assets/js/2.43c9eafb.js" as="script"><link rel="preload" href="/assets/js/8.20166d5a.js" as="script"><link rel="prefetch" href="/assets/js/3.608c34a9.js"><link rel="prefetch" href="/assets/js/4.e1e78894.js"><link rel="prefetch" href="/assets/js/5.81d08115.js"><link rel="prefetch" href="/assets/js/6.587b0c50.js"><link rel="prefetch" href="/assets/js/7.a70f164c.js"><link rel="prefetch" href="/assets/js/9.c599882d.js">
    <link rel="stylesheet" href="0.styles.a2f7be03.css" tppabs="https://wallet.formless.me/assets/css/0.styles.a2f7be03.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="index-2.htm" tppabs="https://wallet.formless.me/tw/" aria-current="page" class="home-link router-link-exact-active router-link-active"><!----> <span class="site-name">FormLess Extention 開發者文檔</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">選擇語言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">選擇語言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="index.htm" tppabs="https://wallet.formless.me/" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="index-1.htm" tppabs="https://wallet.formless.me/zh/" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="index-2.htm" tppabs="https://wallet.formless.me/tw/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  繁體中文
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">選擇語言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">選擇語言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="index.htm" tppabs="https://wallet.formless.me/" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="index-1.htm" tppabs="https://wallet.formless.me/zh/" class="nav-link">
  简体中文
</a></li><li class="dropdown-item"><!----> <a href="index-2.htm" tppabs="https://wallet.formless.me/tw/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  繁體中文
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>開發者文檔</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="index-2.htm" tppabs="https://wallet.formless.me/tw/" aria-current="page" class="active sidebar-link">開發者文檔</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="index-2.htm#基本用法" tppabs="https://wallet.formless.me/tw/#基本用法" class="sidebar-link">基本用法</a></li><li class="sidebar-sub-header"><a href="index-2.htm#formless-isformless" tppabs="https://wallet.formless.me/tw/#formless-isformless" class="sidebar-link">formless.isFormless</a></li><li class="sidebar-sub-header"><a href="index-2.htm#方法" tppabs="https://wallet.formless.me/tw/#方法" class="sidebar-link">方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="index-2.htm#formless-isconnected" tppabs="https://wallet.formless.me/tw/#formless-isconnected" class="sidebar-link">formless.isConnected()</a></li><li class="sidebar-sub-header"><a href="index-2.htm#formless-request-args" tppabs="https://wallet.formless.me/tw/#formless-request-args" class="sidebar-link">formless.request(args)</a></li><li class="sidebar-sub-header"><a href="index-2.htm#formless-requestchainid" tppabs="https://wallet.formless.me/tw/#formless-requestchainid" class="sidebar-link">formless.requestChainId()</a></li><li class="sidebar-sub-header"><a href="index-2.htm#formless-requestaccounts" tppabs="https://wallet.formless.me/tw/#formless-requestaccounts" class="sidebar-link">formless.requestAccounts()</a></li></ul></li><li class="sidebar-sub-header"><a href="index-2.htm#事件" tppabs="https://wallet.formless.me/tw/#事件" class="sidebar-link">事件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="index-2.htm#connect" tppabs="https://wallet.formless.me/tw/#connect" class="sidebar-link">connect</a></li><li class="sidebar-sub-header"><a href="index-2.htm#disconnect" tppabs="https://wallet.formless.me/tw/#disconnect" class="sidebar-link">disconnect</a></li><li class="sidebar-sub-header"><a href="index-2.htm#accountschanged" tppabs="https://wallet.formless.me/tw/#accountschanged" class="sidebar-link">accountsChanged</a></li><li class="sidebar-sub-header"><a href="index-2.htm#chainchanged" tppabs="https://wallet.formless.me/tw/#chainchanged" class="sidebar-link">chainChanged</a></li><li class="sidebar-sub-header"><a href="index-2.htm#message" tppabs="https://wallet.formless.me/tw/#message" class="sidebar-link">message</a></li></ul></li><li class="sidebar-sub-header"><a href="index-2.htm#錯誤信息" tppabs="https://wallet.formless.me/tw/#錯誤信息" class="sidebar-link">錯誤信息</a></li><li class="sidebar-sub-header"><a href="index-2.htm#其它" tppabs="https://wallet.formless.me/tw/#其它" class="sidebar-link">其它</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="index-2.htm#素材" tppabs="https://wallet.formless.me/tw/#素材" class="sidebar-link">素材</a></li><li class="sidebar-sub-header"><a href="index-2.htm#引導下載" tppabs="https://wallet.formless.me/tw/#引導下載" class="sidebar-link">引導下載</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="開發者文檔"><a href="#開發者文檔" class="header-anchor">#</a> 開發者文檔</h1> <div class="custom-block tip"><p class="custom-block-title">介紹</p> <p>FormLess Extention 會向用戶訪問的網站註入了一個全局 API window.formless，由此來連接到FormLess Extention。</p> <p>該 API 規範大量借鑒了 MetaMask 提供的 API ，因此，Web3 開發人員可以輕松地將 dApp 與FormLess Extention連接起來。這些 API 允許網站請求用戶的FormLess Extention地址，從用戶連接的區塊鏈中讀取數據，提示用戶簽署消息和交易，允許網站新增或切換網絡等。</p> <p>FormLess Extention提供的 API 包括<a href="https://eips.ethereum.org/EIPS/eip-1193" tppabs="https://eips.ethereum.org/EIPS/eip-1193" target="_blank" rel="noopener noreferrer">EIP-1193<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 指定的 API 和<a href="https://docs.metamask.io/guide/ethereum-provider.html" tppabs="https://docs.metamask.io/guide/ethereum-provider.html" target="_blank" rel="noopener noreferrer">MetaMask<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 定義的 API。</p></div> <h2 id="基本用法"><a href="#基本用法" class="header-anchor">#</a> 基本用法</h2> <p>對於任何基於Ethereum、Polygon 、BSC、 HECO、OKExChain等EVM系的Web3應用程序，您必須：</p> <ol><li>檢測FormLess Extention (window.formless)</li> <li>檢測用戶連接到哪個網絡</li> <li>獲取用戶的賬戶地址</li></ol> <p>這段代碼解釋了如何完成上述第2、3點要求：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/**********************************************************/</span>
<span class="token comment">/* Handle chain (network) and chainChanged (per EIP-1193) */</span>
<span class="token comment">/**********************************************************/</span>

<span class="token comment">// Normally, we would recommend the 'eth_chainId' RPC method, but it currently</span>
<span class="token comment">// returns incorrectly formatted chain ID values.</span>
<span class="token keyword">let</span> currentChainId <span class="token operator">=</span> formless<span class="token punctuation">.</span>chainId<span class="token punctuation">;</span>

formless<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'chainChanged'</span><span class="token punctuation">,</span> handleChainChanged<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">handleChainChanged</span><span class="token punctuation">(</span><span class="token parameter">_chainId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// We recommend reloading the page, unless you must do otherwise</span>
  window<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/***********************************************************/</span>
<span class="token comment">/* Handle user accounts and accountsChanged (per EIP-1193) */</span>
<span class="token comment">/***********************************************************/</span>

<span class="token keyword">let</span> currentAccount <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
formless
  <span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span> method<span class="token operator">:</span> <span class="token string">'eth_accounts'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>handleAccountsChanged<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Some unexpected error.</span>
    <span class="token comment">// For backwards compatibility reasons, if no accounts are available,</span>
    <span class="token comment">// eth_accounts will return an empty array.</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Note that this event is emitted on page load.</span>
<span class="token comment">// If the array of accounts is non-empty, you're already</span>
<span class="token comment">// connected.</span>
formless<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'accountsChanged'</span><span class="token punctuation">,</span> handleAccountsChanged<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// For now, 'eth_accounts' will continue to always return an array</span>
<span class="token keyword">function</span> <span class="token function">handleAccountsChanged</span><span class="token punctuation">(</span><span class="token parameter">accounts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>accounts<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// formless is locked or the user has not connected any accounts</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Please connect to Formless Wallet.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!==</span> currentAccount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    currentAccount <span class="token operator">=</span> accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// Do any other work!</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/*********************************************/</span>
<span class="token comment">/* Access the user's accounts (per EIP-1102) */</span>
<span class="token comment">/*********************************************/</span>

<span class="token comment">// You should only attempt to request the user's accounts in response to user</span>
<span class="token comment">// interaction, such as a button click.</span>
<span class="token comment">// Otherwise, you popup-spam the user like it's 1999.</span>
<span class="token comment">// If you fail to retrieve the user's account(s), you should encourage the user</span>
<span class="token comment">// to initiate the attempt.</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'connectButton'</span><span class="token punctuation">,</span> connect<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  formless
    <span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span> method<span class="token operator">:</span> <span class="token string">'eth_requestAccounts'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>handleAccountsChanged<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token number">4001</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// EIP-1193 userRejectedRequest error</span>
        <span class="token comment">// If this happens, the user rejected the connection request.</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Please connect to Formless Wallet.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h1 id="屬性"><a href="#屬性" class="header-anchor">#</a> 屬性</h1> <h2 id="formless-isformless"><a href="#formless-isformless" class="header-anchor">#</a> formless.isFormless</h2> <div class="custom-block warning"><p class="custom-block-title">註意</p> <p>此屬性是非標準的。非FormLess Extention插件錢包也可以將此屬性設置為 <code>true</code>。</p></div> <p>如果用戶安裝了FormLess Extention，則為 <code>true</code>。</p> <h2 id="方法"><a href="#方法" class="header-anchor">#</a> 方法</h2> <h3 id="formless-isconnected"><a href="#formless-isconnected" class="header-anchor">#</a> formless.isConnected()</h3> <p>如果提供者連接到當前鏈，則返回<code>true</code>，否則返回<code>false</code>。 更多信息請參考<a href="https://docs.metamask.io/guide/ethereum-provider.html#ethereum-isconnected" tppabs="https://docs.metamask.io/guide/ethereum-provider.html#ethereum-isconnected" target="_blank" rel="noopener noreferrer">MetaMask Doc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ，唯一的區別是我們註入了不同的對象。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>formless<span class="token punctuation">.</span><span class="token function">isConnected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> boolean<span class="token punctuation">;</span>
</code></pre></div><h3 id="formless-request-args"><a href="#formless-request-args" class="header-anchor">#</a> formless.request(args)</h3> <p>通過FormLess Extention，用<code>request</code>向以太坊提交 RPC 請求。更多信息請參考<a href="https://docs.metamask.io/guide/ethereum-provider.html#ethereum-request-args" tppabs="https://docs.metamask.io/guide/ethereum-provider.html#ethereum-request-args" target="_blank" rel="noopener noreferrer">MetaMask Doc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，唯一的區別是我們註入了不同的對象。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">interface</span> <span class="token class-name">RequestArguments</span> <span class="token punctuation">{</span>
  method<span class="token operator">:</span> string<span class="token punctuation">;</span>
  params<span class="token operator">?</span><span class="token operator">:</span> unknown<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> object<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

formless<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span>args<span class="token operator">:</span> RequestArguments<span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>unknown<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="wallet-switchethereumchain"><a href="#wallet-switchethereumchain" class="header-anchor">#</a> wallet_switchEthereumChain</h4> <p>如果需要切換到以太坊網絡，請使用此方法。更多信息請參考<a href="https://docs.metamask.io/guide/rpc-api.html#usage-with-wallet-switchethereumchain" tppabs="https://docs.metamask.io/guide/rpc-api.html#usage-with-wallet-switchethereumchain" target="_blank" rel="noopener noreferrer">MetaMask Doc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> formless<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    method<span class="token operator">:</span> <span class="token string">'wallet_switchEthereumChain'</span><span class="token punctuation">,</span>
    params<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> chainId<span class="token operator">:</span> <span class="token string">'0xf00'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>switchError<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// This error code indicates that the chain has not been added to Formless Wallet.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>code <span class="token operator">===</span> <span class="token number">4902</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">await</span> formless<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        method<span class="token operator">:</span> <span class="token string">'wallet_addEthereumChain'</span><span class="token punctuation">,</span>
        params<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> chainId<span class="token operator">:</span> <span class="token string">'0xf00'</span><span class="token punctuation">,</span> rpcUrl<span class="token operator">:</span> <span class="token string">'https://...'</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>addError<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// handle &quot;add&quot; error</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// handle other &quot;switch&quot; errors</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="formless-requestchainid"><a href="#formless-requestchainid" class="header-anchor">#</a> formless.requestChainId()</h3> <p>可以獲取到當前錢包的鏈id。更多信息請參考<a href="https://docs.metamask.io/guide/ethereum-provider.html#ethereum-chainid-deprecated" tppabs="https://docs.metamask.io/guide/ethereum-provider.html#ethereum-chainid-deprecated" target="_blank" rel="noopener noreferrer">MetaMask Doc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，唯一的區別是我們註入了不同的對象。</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>formless<span class="token punctuation">.</span><span class="token function">requestChainId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="formless-requestaccounts"><a href="#formless-requestaccounts" class="header-anchor">#</a> formless.requestAccounts()</h3> <p>請參考<a href="https://docs.metamask.io/guide/ethereum-provider.html#ethereum-selectedaddress-deprecated" tppabs="https://docs.metamask.io/guide/ethereum-provider.html#ethereum-selectedaddress-deprecated" target="_blank" rel="noopener noreferrer">MetaMask Doc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，唯一的區別是我們註入了不同的對象。</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>formless<span class="token punctuation">.</span><span class="token function">requestAccounts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="事件"><a href="#事件" class="header-anchor">#</a> 事件</h2> <p>請參考<a href="https://docs.metamask.io/guide/ethereum-provider.html#events" tppabs="https://docs.metamask.io/guide/ethereum-provider.html#events" target="_blank" rel="noopener noreferrer">MetaMask Doc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，唯一的區別是我們註入了不同的對象。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>formless<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'accountsChanged'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">accounts</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Handle the new accounts, or lack thereof.</span>
  <span class="token comment">// &quot;accounts&quot; will always be an array, but it can be empty.</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

formless<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'chainChanged'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chainId</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Handle the new chain.</span>
  <span class="token comment">// Correctly handling chain changes can be complicated.</span>
  <span class="token comment">// We recommend reloading the page unless you have a very good reason not to.</span>
  window<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="connect"><a href="#connect" class="header-anchor">#</a> connect</h3> <p>請參考<a href="https://docs.metamask.io/guide/ethereum-provider.html#connect" tppabs="https://docs.metamask.io/guide/ethereum-provider.html#connect" target="_blank" rel="noopener noreferrer">MetaMask Doc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，唯一的區別是我們註入了不同的對象。</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">ConnectInfo</span> <span class="token punctuation">{</span>
  chainId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

formless<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connect'</span><span class="token punctuation">,</span> <span class="token function-variable function">handler</span><span class="token operator">:</span> <span class="token punctuation">(</span>connectInfo<span class="token operator">:</span> ConnectInfo<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="disconnect"><a href="#disconnect" class="header-anchor">#</a> disconnect</h3> <p>請參考<a href="https://docs.metamask.io/guide/ethereum-provider.html#disconnect" target="_blank" rel="noopener noreferrer">MetaMask Doc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，唯一的區別是我們註入了不同的對象。</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>formless<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'disconnect'</span><span class="token punctuation">,</span> <span class="token function-variable function">handler</span><span class="token operator">:</span> <span class="token punctuation">(</span>error<span class="token operator">:</span> ProviderRpcError<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="accountschanged"><a href="#accountschanged" class="header-anchor">#</a> accountsChanged</h3> <p>請參考<a href="https://docs.metamask.io/guide/ethereum-provider.html#accountschanged" tppabs="https://docs.metamask.io/guide/ethereum-provider.html#accountschanged" target="_blank" rel="noopener noreferrer">MetaMask Doc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，唯一的區別是我們註入了不同的對象。</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>formless<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'accountsChanged'</span><span class="token punctuation">,</span> <span class="token function-variable function">handler</span><span class="token operator">:</span> <span class="token punctuation">(</span>accounts<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="chainchanged"><a href="#chainchanged" class="header-anchor">#</a> chainChanged</h3> <p>請參考<a href="https://docs.metamask.io/guide/ethereum-provider.html#chainchanged" target="_blank" rel="noopener noreferrer">MetaMask Doc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，唯一的區別是我們註入了不同的對象。</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code>formless<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'chainChanged'</span><span class="token punctuation">,</span> <span class="token function-variable function">handler</span><span class="token operator">:</span> <span class="token punctuation">(</span>chainId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

formless<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'chainChanged'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>_chainId<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="message"><a href="#message" class="header-anchor">#</a> message</h3> <p>請參考<a href="https://docs.metamask.io/guide/ethereum-provider.html#message" tppabs="https://docs.metamask.io/guide/ethereum-provider.html#message" target="_blank" rel="noopener noreferrer">MetaMask Doc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，唯一的區別是我們註入了不同的對象。</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">ProviderMessage</span> <span class="token punctuation">{</span>
type<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
data<span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

formless<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token function-variable function">handler</span><span class="token operator">:</span> <span class="token punctuation">(</span>message<span class="token operator">:</span> ProviderMessage<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="錯誤信息"><a href="#錯誤信息" class="header-anchor">#</a> 錯誤信息</h2> <p>請參考<a href="https://docs.metamask.io/guide/ethereum-provider.html#errors" tppabs="https://docs.metamask.io/guide/ethereum-provider.html#errors" target="_blank" rel="noopener noreferrer">MetaMask Doc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，唯一的區別是我們註入了不同的對象。</p> <h2 id="其它"><a href="#其它" class="header-anchor">#</a> 其它</h2> <h3 id="素材"><a href="#素材" class="header-anchor">#</a> 素材</h3> <p>引導用戶連接FormLess Extention時，如果網站開發者需要為用戶展示錢包Logo及錢包名稱，可以通過以下素材進行配置。</p> <p><a href="FormLess_Logo.zip" tppabs="https://wallet.formless.me/FormLess_Logo.zip">點擊下載FormLess Logo</a>
推薦的插件名稱：FormLess Extention</p> <h3 id="引導下載"><a href="#引導下載" class="header-anchor">#</a> 引導下載</h3> <p>在用戶未下載FormLess Extention時，如果網站開發者需要引導用戶下載。可使用以下應用市場鏈接：</p> <p>Chrome下載地址：</p> <p><a href="https://chrome.google.com/webstore/detail/formless/bedankimochhfaikjlbipbpddcpnebff?hl=en" target="_blank" rel="noopener noreferrer">https://chrome.google.com/webstore/detail/formless/bedankimochhfaikjlbipbpddcpnebff?hl=en<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="custom-block tip"><p class="custom-block-title">FormLess Extention建議引導下載邏輯</p> <p>如果是Chrome内核瀏覽器，則引導去chrome應用市場。</p></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="app.c9e8d0a3.js" tppabs="https://wallet.formless.me/assets/js/app.c9e8d0a3.js" defer></script><script src="2.43c9eafb.js" tppabs="https://wallet.formless.me/assets/js/2.43c9eafb.js" defer></script><script src="8.20166d5a.js" tppabs="https://wallet.formless.me/assets/js/8.20166d5a.js" defer></script>
  </body>
</html>
